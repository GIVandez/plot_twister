tests/models/test_admin_model.py::TestAdminModel::test_m11_new_user_with_valid_data PASSED [  1%]
tests/models/test_admin_model.py::TestAdminModel::test_m12_new_user_with_existing_login PASSED [  2%]
tests/models/test_admin_model.py::TestAdminModel::test_m13_new_user_without_password PASSED [  3%]
tests/models/test_admin_model.py::TestAdminModel::test_m14_new_user_without_username PASSED [  4%]
tests/models/test_admin_model.py::TestAdminModel::test_m15_give_admin_role_to_existing_user PASSED [  5%]
tests/models/test_admin_model.py::TestAdminModel::test_m16_give_admin_role_to_non_existing_user PASSED [  6%]
tests/models/test_admin_model.py::TestAdminModel::test_m17_remove_admin_role_from_user PASSED [  7%]
tests/models/test_admin_model.py::TestAdminModel::test_m18_remove_admin_role_from_non_existing_user PASSED [  8%]
tests/models/test_admin_model.py::TestAdminModel::test_m19_edit_existing_user_info_by_admin PASSED [  9%]
tests/models/test_admin_model.py::TestAdminModel::test_m20_edit_non_existing_user_info_by_admin PASSED [ 10%]
tests/models/test_admin_model.py::TestAdminModel::test_m21_delete_existing_user_by_admin PASSED [ 11%]
tests/models/test_admin_model.py::TestAdminModel::test_m22_delete_non_existing_user_by_admin PASSED [ 12%]
tests/models/test_all_models.py::TestUserModel::test_get_existing_user_info PASSED 
[ 13%]
tests/models/test_all_models.py::TestUserModel::test_get_non_existing_user PASSED [ 14%]
tests/models/test_all_models.py::TestUserModel::test_get_user_projects PASSED [ 15%]
tests/models/test_all_models.py::TestUserModel::test_edit_user_info_success PASSED 
[ 16%]
tests/models/test_all_models.py::TestUserModel::test_edit_without_username PASSED [ 17%]
tests/models/test_all_models.py::TestUserModel::test_delete_user_success PASSED [ 18%]
tests/models/test_all_models.py::TestUserModel::test_delete_nonexistent_user PASSED [ 19%]
tests/models/test_all_models.py::TestAdminModel::test_new_user_success PASSED [ 20%]
tests/models/test_all_models.py::TestAdminModel::test_new_user_exists PASSED [ 21%]tests/models/test_all_models.py::TestAdminModel::test_new_user_no_password PASSED [ 22%]
tests/models/test_all_models.py::TestAdminModel::test_give_admin_role PASSED [ 23%]tests/models/test_all_models.py::TestAdminModel::test_edit_user_info PASSED [ 24%] 
tests/models/test_all_models.py::TestAuthModel::test_login_success PASSED   [ 25%]
tests/models/test_all_models.py::TestAuthModel::test_login_wrong_password PASSED [ 
26%]
tests/models/test_all_models.py::TestAuthModel::test_login_user_not_found PASSED [ 
27%]
tests/models/test_all_models.py::TestAuthModel::test_register_success PASSED [ 28%]tests/models/test_all_models.py::TestAuthModel::test_register_user_exists PASSED [ 
29%]
tests/models/test_auth_model.py::TestAuthModel::test_m23_successful_login PASSED [ 
30%]
tests/models/test_auth_model.py::TestAuthModel::test_m24_login_with_wrong_password 
PASSED [ 31%]
tests/models/test_auth_model.py::TestAuthModel::test_m25_login_with_non_existing_user PASSED [ 32%]
tests/models/test_auth_model.py::TestAuthModel::test_m26_successful_registration PASSED [ 33%]
tests/models/test_auth_model.py::TestAuthModel::test_m27_registration_with_existing_user PASSED [ 34%]
tests/models/test_frame_model.py::TestFrameModel::test_new_frame_with_all_data PASSED [ 35%]
tests/models/test_frame_model.py::TestFrameModel::test_new_frame_auto_number PASSED [ 36%]
tests/models/test_frame_model.py::TestFrameModel::test_new_frame_missing_required_data PASSED [ 37%]
tests/models/test_frame_model.py::TestFrameModel::test_new_frame_project_not_found 
PASSED [ 38%]
tests/models/test_frame_model.py::TestFrameModel::test_get_frame_info_success PASSED [ 39%]
tests/models/test_frame_model.py::TestFrameModel::test_get_frame_info_not_found PASSED [ 40%]
tests/models/test_frame_model.py::TestFrameModel::test_edit_frame_info_success PASSED [ 41%]
tests/models/test_frame_model.py::TestFrameModel::test_edit_frame_info_failure PASSED [ 42%]
tests/models/test_frame_model.py::TestFrameModel::test_update_frame_number_success 
PASSED [ 43%]
tests/models/test_frame_model.py::TestFrameModel::test_delete_frame_success PASSED 
[ 44%]
tests/models/test_frame_model.py::TestFrameModel::test_delete_frame_not_found PASSED [ 45%]
tests/models/test_frame_model.py::TestFrameModel::test_get_project_frames_successP 
ASSED [ 46%]
tests/models/test_frame_model.py::TestFrameModel::test_get_project_frames_project_not_found PASSED [ 47%]
tests/models/test_frame_model.py::TestFrameModel::test_get_frame_pic_exists PASSED 
[ 48%]
tests/models/test_frame_model.py::TestFrameModel::test_get_frame_pic_not_exists PASSED [ 50%]
tests/models/test_frame_model.py::TestFrameModel::test_upload_frame_pic_from_file_object PASSED [ 51%]
tests/models/test_frame_model.py::TestFrameModel::test_upload_frame_pic_from_bytes 
PASSED [ 52%]
tests/models/test_frame_model.py::TestFrameModel::test_delete_frame_pic_exists PASSED [ 53%]
tests/models/test_frame_model.py::TestFrameModel::test_delete_frame_pic_not_exists 
PASSED [ 54%]
tests/models/test_frame_model.py::TestFrameModel::test_delete_frame_pic_frame_not_found PASSED [ 55%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_get_pic_exists PASSED [ 56%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_get_pic_file_not_exists PASSED [ 57%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_get_pic_frame_not_found PASSED [ 58%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_get_pic_no_pic_path PASSED [ 59%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_from_file_object PASSED [ 60%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_from_bytes PASSED [ 61%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_from_file_path PASSED [ 62%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_source_not_exists PASSED [ 63%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_db_update_failure PASSED [ 64%]
tests/models/test_graphic_editor_model.py::TestGraphicEditorModel::test_upload_pic_exception_handling PASSED [ 65%]
tests/models/test_page_model.py::TestPageModel::test_new_page_with_number_and_text 
FAILED [ 66%]
tests/models/test_page_model.py::TestPageModel::test_new_page_auto_number FAILED [ 
67%]
tests/models/test_page_model.py::TestPageModel::test_new_page_project_not_found PASSED [ 68%]
tests/models/test_page_model.py::TestPageModel::test_get_page_success PASSED [ 69%]tests/models/test_page_model.py::TestPageModel::test_get_page_not_found PASSED [ 70%]
tests/models/test_page_model.py::TestPageModel::test_edit_page_text_only PASSED [ 71%]
tests/models/test_page_model.py::TestPageModel::test_edit_page_number_only PASSED [ 72%]
tests/models/test_page_model.py::TestPageModel::test_edit_page_text_and_number PASSED [ 73%]
tests/models/test_page_model.py::TestPageModel::test_edit_page_failure PASSED [ 74%]
tests/models/test_page_model.py::TestPageModel::test_delete_page_success PASSED [ 75%]
tests/models/test_page_model.py::TestPageModel::test_delete_page_not_found PASSED [ 76%]
tests/models/test_project_model.py::TestProjectModel::test_new_project_success PASSED [ 77%]
tests/models/test_project_model.py::TestProjectModel::test_new_project_already_exists PASSED [ 78%]
tests/models/test_project_model.py::TestProjectModel::test_new_project_user_not_found PASSED [ 79%]
tests/models/test_project_model.py::TestProjectModel::test_edit_project_name_success PASSED [ 80%]
tests/models/test_project_model.py::TestProjectModel::test_edit_project_name_failure PASSED [ 81%]
tests/models/test_project_model.py::TestProjectModel::test_delete_project_success PASSED [ 82%]
tests/models/test_project_model.py::TestProjectModel::test_delete_project_failure PASSED [ 83%]
tests/models/test_project_model.py::TestProjectModel::test_delete_script_success PASSED [ 84%]
tests/models/test_project_model.py::TestProjectModel::test_delete_script_no_pagesP 
ASSED [ 85%]
tests/models/test_project_model.py::TestProjectModel::test_delete_frames_success PASSED [ 86%]
tests/models/test_project_model.py::TestProjectModel::test_connect_fp_success PASSED [ 87%]
tests/models/test_project_model.py::TestProjectModel::test_connect_fp_frame_not_found PASSED [ 88%]
tests/models/test_project_model.py::TestProjectModel::test_disconnect_fp_success PASSED [ 89%]
tests/models/test_user_model.py::TestUserModel::test_m1_get_existing_user_info PASSED [ 90%]
tests/models/test_user_model.py::TestUserModel::test_m2_get_non_existing_user_info 
PASSED [ 91%]
tests/models/test_user_model.py::TestUserModel::test_m3_get_user_info_without_email PASSED [ 92%]
tests/models/test_user_model.py::TestUserModel::test_m4_get_projects_for_user_with_projects PASSED [ 93%]
tests/models/test_user_model.py::TestUserModel::test_m5_get_projects_for_user_without_projects PASSED [ 94%]
tests/models/test_user_model.py::TestUserModel::test_m6_edit_user_info_success PASSED [ 95%]
tests/models/test_user_model.py::TestUserModel::test_m7_edit_non_existing_user_info PASSED [ 96%]
tests/models/test_user_model.py::TestUserModel::test_m8_edit_user_info_without_username PASSED [ 97%]
tests/models/test_user_model.py::TestUserModel::test_m9_delete_existing_user PASSED [ 98%]
tests/models/test_user_model.py::TestUserModel::test_m10_delete_non_existing_user PASSED [100%]

==================================== FAILURES ==================================== 
________________ TestPageModel.test_new_page_with_number_and_text ________________ 

self = <test_page_model.TestPageModel object at 0x00000222C0A05FD0>
page_model = <project_data_models.page_model.PageModel object at 0x00000222C0AE3A90>

    def test_new_page_with_number_and_text(self, page_model):
        """Тест: Создание новой страницы с номером и текстом"""
        # Arrange
        project_id = 1
        number = 5
        text = "Test page content"
        mock_session = Mock()
        mock_page = Mock()
        mock_page.id = 100

        page_model.Session.return_value = mock_session
        mock_session.query.return_value.filter.return_value.first.return_value = Mock()  # project exists

        with patch('database.models.Page', return_value=mock_page):
            # Act
            result = page_model.new_page(project_id, number, text)

            # Assert
>           assert result == 100
E           assert None == 100

tests\models\test_page_model.py:46: AssertionError
____________________ TestPageModel.test_new_page_auto_number _____________________ 

self = <test_page_model.TestPageModel object at 0x00000222C0A06350>
page_model = <project_data_models.page_model.PageModel object at 0x00000222C0AD1190>

    def test_new_page_auto_number(self, page_model):
        """Тест: Создание страницы с автоматическим номером"""
        # Arrange
        project_id = 1
        text = "Test content"
        mock_session = Mock()
        mock_page = Mock()
        mock_page.id = 101

        page_model.Session.return_value = mock_session
        mock_session.query.return_value.filter.return_value.first.return_value = Mock()  # project exists
        mock_session.query.return_value.filter.return_value.order_by.return_value.first.return_value = (3,)  # max number is 3

        with patch('database.models.Page', return_value=mock_page):
            # Act
            result = page_model.new_page(project_id, None, text)

            # Assert
>           assert result == 101
E           assert None == 101

tests\models\test_page_model.py:68: AssertionError
================================ warnings summary ================================ 
src\database\models.py:6
  D:\Code\five\plot_twister\tests\models\..\..\src\database\models.py:6: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    Base = declarative_base()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================ short test summary info ============================= 
FAILED tests/models/test_page_model.py::TestPageModel::test_new_page_with_number_and_text - assert None == 100
FAILED tests/models/test_page_model.py::TestPageModel::test_new_page_auto_number - 
assert None == 101
==================== 2 failed, 96 passed, 1 warning in 2.09s =====================